import{S as e,i as t,s,e as n,H as a,c as o,a as l,d as i,b as c,I as r,f as h,F as f,J as p,G as u,t as d,k as m,g,n as v,K as y,L as w,j as E,m as $,o as x,v as b,r as k,w as I,M as D,N as S,O as H,h as M,P as V,Q as C,u as N,R as T,T as A,U as B,V as P,W as L,z as O,X as j,Y as R,Z as U,_ as q,$ as z,a0 as F,a1 as J,B as W,a2 as Y,a3 as G,a4 as K}from"../chunks/vendor-3ef4e6dd.js";function Q(e){let t,s,d,m,g,v,y;return{c(){t=n("button"),s=a("svg"),d=a("line"),m=a("line"),g=a("line"),this.h()},l(e){t=o(e,"BUTTON",{class:!0});var n=l(t);s=o(n,"svg",{width:!0,height:!0,class:!0},1);var a=l(s);d=o(a,"line",{id:!0,x1:!0,y1:!0,x2:!0,y2:!0,class:!0},1),l(d).forEach(i),m=o(a,"line",{id:!0,x1:!0,y1:!0,x2:!0,y2:!0,class:!0},1),l(m).forEach(i),g=o(a,"line",{id:!0,x1:!0,y1:!0,x2:!0,y2:!0,class:!0},1),l(g).forEach(i),a.forEach(i),n.forEach(i),this.h()},h(){c(d,"id","top"),c(d,"x1","0"),c(d,"y1","2"),c(d,"x2","32"),c(d,"y2","2"),c(d,"class","svelte-nwxs19"),c(m,"id","middle"),c(m,"x1","0"),c(m,"y1","12"),c(m,"x2","32"),c(m,"y2","12"),c(m,"class","svelte-nwxs19"),c(g,"id","bottom"),c(g,"x1","0"),c(g,"y1","22"),c(g,"x2","32"),c(g,"y2","22"),c(g,"class","svelte-nwxs19"),c(s,"width","32"),c(s,"height","24"),c(s,"class","svelte-nwxs19"),c(t,"class","svelte-nwxs19"),r(t,"open",e[0])},m(n,a){h(n,t,a),f(t,s),f(s,d),f(s,m),f(s,g),v||(y=p(t,"click",e[1]),v=!0)},p(e,[s]){1&s&&r(t,"open",e[0])},i:u,o:u,d(e){e&&i(t),v=!1,y()}}}function X(e,t,s){let{open:n=!1}=t;return e.$$set=e=>{"open"in e&&s(0,n=e.open)},[n,()=>s(0,n=!n)]}class Z extends e{constructor(e){super(),t(this,e,X,Q,s,{open:0})}}function _(e){let t,s,a,E,$,x,b,k,I,D,S,H;return{c(){t=n("aside"),s=n("nav"),a=n("item"),E=d("Search"),$=m(),x=n("item"),b=d("Export"),k=m(),I=n("item"),D=d("Help"),this.h()},l(e){t=o(e,"ASIDE",{class:!0});var n=l(t);s=o(n,"NAV",{class:!0});var c=l(s);a=o(c,"ITEM",{class:!0});var r=l(a);E=g(r,"Search"),r.forEach(i),$=v(c),x=o(c,"ITEM",{class:!0});var h=l(x);b=g(h,"Export"),h.forEach(i),k=v(c),I=o(c,"ITEM",{class:!0});var f=l(I);D=g(f,"Help"),f.forEach(i),c.forEach(i),n.forEach(i),this.h()},h(){c(a,"class","svelte-i1zqfl"),c(x,"class","svelte-i1zqfl"),c(I,"class","svelte-i1zqfl"),c(s,"class",""),c(t,"class"," svelte-i1zqfl"),r(t,"open",e[0])},m(n,o){h(n,t,o),f(t,s),f(s,a),f(a,E),f(s,$),f(s,x),f(x,b),f(s,k),f(s,I),f(I,D),S||(H=[p(a,"click",(function(){y(e[3])&&e[3].apply(this,arguments)})),p(x,"click",(function(){y(e[1])&&e[1].apply(this,arguments)})),p(I,"click",(function(){y(e[2])&&e[2].apply(this,arguments)}))],S=!0)},p(s,[n]){e=s,1&n&&r(t,"open",e[0])},i:u,o:u,d(e){e&&i(t),S=!1,w(H)}}}function ee(e,t,s){let{open:n=!1}=t,{exportData:a}=t,{toggleHelp:o}=t,{toggleSearch:l}=t;return e.$$set=e=>{"open"in e&&s(0,n=e.open),"exportData"in e&&s(1,a=e.exportData),"toggleHelp"in e&&s(2,o=e.toggleHelp),"toggleSearch"in e&&s(3,l=e.toggleSearch)},[n,a,o,l]}class te extends e{constructor(e){super(),t(this,e,ee,_,s,{open:0,exportData:1,toggleHelp:2,toggleSearch:3})}}function se(e){let t,s,a,r,w,E,$,x,b,k,I,D,S,H,M,V,C,N,T,A,B,P,L,O,j,R,U,q,z,F,J;return{c(){t=n("div"),s=m(),a=n("div"),r=n("h3"),w=d("Introduction"),E=m(),$=n("p"),x=d("Welcome to Easy Match! This is a simple tool to help you match values in two spreadsheet columns."),b=m(),k=n("p"),I=d("For example, suppose you have two lists of names and want to figure out which folks are in both lists. If each such person's name is not printed exactly the same in the two lists, you'll have to painstakingly read through the lists and match names up as you go. Easy Match helps with that."),D=m(),S=n("h3"),H=d("Instructions"),M=m(),V=n("p"),C=d("Begin by copying the first column from your spreadsheet software and then do a paste action with this browser window open. Repeat with the second column."),N=m(),T=n("p"),A=d("Next you'll see a list of suggestions for the first entry in the first column. Choose a match by clicking on it or by pressing the corresponding digit on the keyboard. You can also search to filter possible matches by pressing "),B=n("tt"),P=d("/"),L=d(". Continue until all matches have been found. Export as a CSV or perform a copy action to put the matching on your clipboard."),O=m(),j=n("h3"),R=d("Security"),U=m(),q=n("p"),z=d("Easy Match is secure because your data stays entirely within your browser."),this.h()},l(e){t=o(e,"DIV",{class:!0}),l(t).forEach(i),s=v(e),a=o(e,"DIV",{class:!0});var n=l(a);r=o(n,"H3",{});var c=l(r);w=g(c,"Introduction"),c.forEach(i),E=v(n),$=o(n,"P",{});var h=l($);x=g(h,"Welcome to Easy Match! This is a simple tool to help you match values in two spreadsheet columns."),h.forEach(i),b=v(n),k=o(n,"P",{});var f=l(k);I=g(f,"For example, suppose you have two lists of names and want to figure out which folks are in both lists. If each such person's name is not printed exactly the same in the two lists, you'll have to painstakingly read through the lists and match names up as you go. Easy Match helps with that."),f.forEach(i),D=v(n),S=o(n,"H3",{});var p=l(S);H=g(p,"Instructions"),p.forEach(i),M=v(n),V=o(n,"P",{});var u=l(V);C=g(u,"Begin by copying the first column from your spreadsheet software and then do a paste action with this browser window open. Repeat with the second column."),u.forEach(i),N=v(n),T=o(n,"P",{});var d=l(T);A=g(d,"Next you'll see a list of suggestions for the first entry in the first column. Choose a match by clicking on it or by pressing the corresponding digit on the keyboard. You can also search to filter possible matches by pressing "),B=o(d,"TT",{});var m=l(B);P=g(m,"/"),m.forEach(i),L=g(d,". Continue until all matches have been found. Export as a CSV or perform a copy action to put the matching on your clipboard."),d.forEach(i),O=v(n),j=o(n,"H3",{});var y=l(j);R=g(y,"Security"),y.forEach(i),U=v(n),q=o(n,"P",{});var F=l(q);z=g(F,"Easy Match is secure because your data stays entirely within your browser."),F.forEach(i),n.forEach(i),this.h()},h(){c(t,"class","mask svelte-1ci3i8f"),c(a,"class","help svelte-1ci3i8f")},m(n,o){h(n,t,o),h(n,s,o),h(n,a,o),f(a,r),f(r,w),f(a,E),f(a,$),f($,x),f(a,b),f(a,k),f(k,I),f(a,D),f(a,S),f(S,H),f(a,M),f(a,V),f(V,C),f(a,N),f(a,T),f(T,A),f(T,B),f(B,P),f(T,L),f(a,O),f(a,j),f(j,R),f(a,U),f(a,q),f(q,z),F||(J=p(t,"click",(function(){y(e[0])&&e[0].apply(this,arguments)})),F=!0)},p(t,[s]){e=t},i:u,o:u,d(e){e&&i(t),e&&i(s),e&&i(a),F=!1,J()}}}function ne(e,t,s){let{toggleHelp:n}=t;return e.$$set=e=>{"toggleHelp"in e&&s(0,n=e.toggleHelp)},[n]}class ae extends e{constructor(e){super(),t(this,e,ne,se,s,{toggleHelp:0})}}function oe(e,t){if(0==e.length)return t.length;if(0==t.length)return e.length;var s,n,a=[];for(s=0;s<=t.length;s++)a[s]=[s];for(n=0;n<=e.length;n++)a[0][n]=n;for(s=1;s<=t.length;s++)for(n=1;n<=e.length;n++)t.charAt(s-1)==e.charAt(n-1)?a[s][n]=a[s-1][n-1]:a[s][n]=Math.min(a[s-1][n-1]+1,Math.min(a[s][n-1]+1,a[s-1][n]+1));return a[t.length][e.length]}const{Boolean:le}=j;function ie(e,t,s){const n=e.slice();return n[29]=t[s],n[31]=s,n}function ce(e,t,s){const n=e.slice();return n[32]=t[s],n[34]=s,n}function re(e){let t,s;return t=new ae({props:{toggleHelp:e[14]}}),{c(){E(t.$$.fragment)},l(e){$(t.$$.fragment,e)},m(e,n){x(t,e,n),s=!0},p:u,i(e){s||(b(t.$$.fragment,e),s=!0)},o(e){k(t.$$.fragment,e),s=!1},d(e){I(t,e)}}}function he(e){let t,s,a,r,p,u,m=e[2][e[5][e[31]].id].name+"";return{c(){t=d("⟷\n              "),s=n("span"),a=d(m),this.h()},l(e){t=g(e,"⟷\n              "),s=o(e,"SPAN",{class:!0});var n=l(s);a=g(n,m),n.forEach(i),this.h()},h(){c(s,"class","on-card-match")},m(e,n){h(e,t,n),h(e,s,n),f(s,a),u=!0},p(t,s){e=t,(!u||36&s[0])&&m!==(m=e[2][e[5][e[31]].id].name+"")&&M(a,m)},i(t){u||(V((()=>{p&&p.end(1),r||(r=R(s,e[10],{key:e[2][e[5][e[31]].id].id})),r.start()})),u=!0)},o(e){r&&r.invalidate(),p=C(s,U,{duration:75}),u=!1},d(e){e&&i(t),e&&i(s),e&&p&&p.end()}}}function fe(e){let t,s,a,r=[],f=new Map,p=e[1]&&pe(e),u=e[7];const d=e=>e[32].id;for(let n=0;n<u.length;n+=1){let t=ce(e,u,n),s=d(t);f.set(s,r[n]=ue(s,t))}return{c(){p&&p.c(),t=m(),s=n("div");for(let e=0;e<r.length;e+=1)r[e].c();this.h()},l(e){p&&p.l(e),t=v(e),s=o(e,"DIV",{class:!0});var n=l(s);for(let t=0;t<r.length;t+=1)r[t].l(n);n.forEach(i),this.h()},h(){c(s,"class","right-names svelte-1pihh8o")},m(e,n){p&&p.m(e,n),h(e,t,n),h(e,s,n);for(let t=0;t<r.length;t+=1)r[t].m(s,null);a=!0},p(e,n){if(e[1]?p?p.p(e,n):(p=pe(e),p.c(),p.m(t.parentNode,t)):p&&(p.d(1),p=null),4224&n[0]){u=e[7],W();for(let e=0;e<r.length;e+=1)r[e].r();r=A(r,n,d,1,e,u,f,s,Y,ue,null,ce);for(let e=0;e<r.length;e+=1)r[e].a();N()}},i(e){if(!a){for(let e=0;e<u.length;e+=1)b(r[e]);a=!0}},o(e){for(let t=0;t<r.length;t+=1)k(r[t]);a=!1},d(e){p&&p.d(e),e&&i(t),e&&i(s);for(let t=0;t<r.length;t+=1)r[t].d()}}}function pe(e){let t,s,a,r;return{c(){t=n("div"),s=n("input"),this.h()},l(e){t=o(e,"DIV",{class:!0});var n=l(t);s=o(n,"INPUT",{id:!0,class:!0}),n.forEach(i),this.h()},h(){c(s,"id","search"),c(s,"class","svelte-1pihh8o"),c(t,"class","searching svelte-1pihh8o")},m(n,o){h(n,t,o),f(t,s),T(s,e[0]),a||(r=p(s,"input",e[18]),a=!0)},p(e,t){1&t[0]&&s.value!==e[0]&&T(s,e[0])},d(e){e&&i(t),a=!1,r()}}}function ue(e,t){let s,a,r,y,w,E,$,x,b,k,I,D,S=t[34]+1+"",H=t[32].name+"",N=u;function T(){return t[19](t[34])}return{key:e,first:null,c(){s=n("div"),a=n("span"),r=d(S),y=m(),w=d(H),E=m(),this.h()},l(e){s=o(e,"DIV",{class:!0});var t=l(s);a=o(t,"SPAN",{class:!0});var n=l(a);r=g(n,S),n.forEach(i),y=v(t),w=g(t,H),E=v(t),t.forEach(i),this.h()},h(){c(a,"class","digit svelte-1pihh8o"),c(s,"class","right-name svelte-1pihh8o"),this.first=s},m(e,t){h(e,s,t),f(s,a),f(a,r),f(s,y),f(s,w),f(s,E),k=!0,I||(D=p(s,"click",q(T)),I=!0)},p(e,s){t=e,(!k||128&s[0])&&S!==(S=t[34]+1+"")&&M(r,S),(!k||128&s[0])&&H!==(H=t[32].name+"")&&M(w,H)},r(){b=s.getBoundingClientRect()},f(){z(s),N(),F(s,b)},a(){N(),N=J(s,b,K,{})},i(e){k||(e&&V((()=>{x&&x.end(1),$||($=R(s,U,{})),$.start()})),k=!0)},o(e){$&&$.invalidate(),x=C(s,t[9],{key:t[32].id}),k=!1},d(e){e&&i(s),e&&x&&x.end(),I=!1,D()}}}function de(e){let t,s,a,r,u,y,w,E,$,x,I=e[29].name+"",D=e[2][e[5][e[31]].id]&&he(e),S=e[31]===e[6]&&fe(e);function V(){return e[20](e[31])}return{c(){t=n("div"),s=n("span"),a=d(I),r=m(),D&&D.c(),u=m(),S&&S.c(),y=m(),this.h()},l(e){t=o(e,"DIV",{class:!0});var n=l(t);s=o(n,"SPAN",{});var c=l(s);a=g(c,I),r=v(c),D&&D.l(c),u=v(c),S&&S.l(c),c.forEach(i),y=v(n),n.forEach(i),this.h()},h(){c(t,"class",w=H("left name"+(e[31]===e[6]?" active":""))+" svelte-1pihh8o")},m(e,n){h(e,t,n),f(t,s),f(s,a),f(s,r),D&&D.m(s,null),f(s,u),S&&S.m(s,null),f(t,y),E=!0,$||(x=p(t,"click",V),$=!0)},p(n,o){e=n,(!E||32&o[0])&&I!==(I=e[29].name+"")&&M(a,I),e[2][e[5][e[31]].id]?D?(D.p(e,o),36&o[0]&&b(D,1)):(D=he(e),D.c(),b(D,1),D.m(s,u)):D&&(W(),k(D,1,1,(()=>{D=null})),N()),e[31]===e[6]?S?(S.p(e,o),64&o[0]&&b(S,1)):(S=fe(e),S.c(),b(S,1),S.m(s,null)):S&&(W(),k(S,1,1,(()=>{S=null})),N()),(!E||64&o[0]&&w!==(w=H("left name"+(e[31]===e[6]?" active":""))+" svelte-1pihh8o"))&&c(t,"class",w)},i(e){E||(b(D),b(S),E=!0)},o(e){k(D),k(S),E=!1},d(e){e&&i(t),D&&D.d(),S&&S.d(),$=!1,x()}}}function me(e){let t,s,a,r,p,u,y,w,V,C,T,A,L,O,j,R,U,q,z,F,J=1!==e[8]?"es":"",Y=e[4]&&re(e);function G(t){e[17](t)}let K={};void 0!==e[3]&&(K.open=e[3]),r=new Z({props:K}),D.push((()=>S(r,"open",G))),y=new te({props:{open:e[3],exportData:e[13],toggleHelp:e[14],toggleSearch:e[15]}});let Q=e[5],X=[];for(let n=0;n<Q.length;n+=1)X[n]=de(ie(e,Q,n));const _=e=>k(X[e],1,1,(()=>{X[e]=null}));return{c(){Y&&Y.c(),t=m(),s=n("div"),a=n("nav"),E(r.$$.fragment),u=m(),E(y.$$.fragment),w=m(),V=n("h1"),C=d("Easy Matching"),T=m(),A=n("div"),L=d(e[8]),O=d(" match"),j=d(J),R=m(),U=n("div"),q=n("div");for(let e=0;e<X.length;e+=1)X[e].c();this.h()},l(n){Y&&Y.l(n),t=v(n),s=o(n,"DIV",{class:!0});var c=l(s);a=o(c,"NAV",{class:!0});var h=l(a);$(r.$$.fragment,h),u=v(h),$(y.$$.fragment,h),h.forEach(i),w=v(c),V=o(c,"H1",{class:!0});var f=l(V);C=g(f,"Easy Matching"),f.forEach(i),T=v(c),A=o(c,"DIV",{class:!0});var p=l(A);L=g(p,e[8]),O=g(p," match"),j=g(p,J),p.forEach(i),R=v(c),U=o(c,"DIV",{class:!0});var d=l(U);q=o(d,"DIV",{class:!0});var m=l(q);for(let e=0;e<X.length;e+=1)X[e].l(m);m.forEach(i),d.forEach(i),c.forEach(i),this.h()},h(){c(a,"class","svelte-1pihh8o"),c(V,"class","centered svelte-1pihh8o"),c(A,"class","match-count centered svelte-1pihh8o"),c(q,"class","column svelte-1pihh8o"),c(U,"class","grid-container svelte-1pihh8o"),c(s,"class",z=H(e[4]?"blur":"")+" svelte-1pihh8o")},m(e,n){Y&&Y.m(e,n),h(e,t,n),h(e,s,n),f(s,a),x(r,a,null),f(a,u),x(y,a,null),f(s,w),f(s,V),f(V,C),f(s,T),f(s,A),f(A,L),f(A,O),f(A,j),f(s,R),f(s,U),f(U,q);for(let t=0;t<X.length;t+=1)X[t].m(q,null);F=!0},p(e,n){e[4]?Y?(Y.p(e,n),16&n[0]&&b(Y,1)):(Y=re(e),Y.c(),b(Y,1),Y.m(t.parentNode,t)):Y&&(W(),k(Y,1,1,(()=>{Y=null})),N());const a={};!p&&8&n[0]&&(p=!0,a.open=e[3],B((()=>p=!1))),r.$set(a);const o={};if(8&n[0]&&(o.open=e[3]),y.$set(o),(!F||256&n[0])&&M(L,e[8]),(!F||256&n[0])&&J!==(J=1!==e[8]?"es":"")&&M(j,J),6375&n[0]){let t;for(Q=e[5],t=0;t<Q.length;t+=1){const s=ie(e,Q,t);X[t]?(X[t].p(s,n),b(X[t],1)):(X[t]=de(s),X[t].c(),b(X[t],1),X[t].m(q,null))}for(W(),t=Q.length;t<X.length;t+=1)_(t);N()}(!F||16&n[0]&&z!==(z=H(e[4]?"blur":"")+" svelte-1pihh8o"))&&c(s,"class",z)},i(e){if(!F){b(Y),b(r.$$.fragment,e),b(y.$$.fragment,e);for(let e=0;e<Q.length;e+=1)b(X[e]);F=!0}},o(e){k(Y),k(r.$$.fragment,e),k(y.$$.fragment,e),X=X.filter(le);for(let t=0;t<X.length;t+=1)k(X[t]);F=!1},d(e){Y&&Y.d(e),e&&i(t),e&&i(s),I(r),I(y),P(X,e)}}}function ge(){setTimeout((()=>{const e=document.getElementById("search");e&&e.focus()}),5)}function ve(e,t,s){let n,a;const[o,l]=L({duration:e=>Math.sqrt(200*e),fallback(e,t){const s=getComputedStyle(e),n="none"===s.transform?"":s.transform;return{duration:250,easing:G,css:e=>`\n\t\t\t\t\ttransform: ${n} scale(${e});\n          opacity: ${e};\n\t\t\t\t`}}});let i="left",c="",r=!1,h=!1,f=!1,p=[{id:0,name:"Johnny"},{id:1,name:"Andrea"},{id:2,name:"Cyndi"}],u=[{id:3,name:"John"},{id:4,name:"Cyndy"}],d=5,m=0,g={};function v(e){const t=p[e].id;e!=m?(s(6,m=e),s(16,u=u.sort(((t,s)=>oe(p[e].name,t.name)-oe(p[e].name,s.name)))),ge()):g[t]&&(s(16,u=[g[t],...u]),s(2,g[t]=void 0,g))}function y(e){const t=p[m].id;if(g[t]){const n=g[t];s(2,g[t]=u[e],g);const a=u.slice(0,e).concat(u.slice(e+1));s(16,u=[n,...a])}else s(2,g[t]=u[e],g),s(16,u=u.slice(0,e).concat(u.slice(e+1)))}function w(){s(6,m=0),s(16,u=Object.values(g).filter(Boolean).sort(((e,t)=>e.id-t.id)).concat(u)),s(2,g={})}function E(e){const t=p.map(((e,t)=>g[e.id]&&g[e.id].name||"")).join("\n");e.clipboardData.setData("text/plain",t)}function $(e){return e.split("\n").map((e=>({id:d++,name:e})))}function x(e){const t=e.clipboardData.getData("text/plain");"left"===i?(s(5,p=$(t)),i="right",w()):(s(16,u=$(t)),i="left",w())}function b(){!function({filename:e,data:t,type:s="plain"}={}){const n=new Blob([t],{type:"text/"+s});if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveBlob(n,e);else{const t=window.document.createElement("a");t.href=window.URL.createObjectURL(n),t.download=e,document.body.appendChild(t),t.click(),document.body.removeChild(t)}}({filename:"matching.csv",data:p.map(((e,t)=>e.name+","+(g[e.id]&&g[e.id].name||""))).join("\n"),type:"csv"})}const k=new Set(["1","2","3","4","5","6","7","8","9"]);function I(e){if("ArrowUp"===e.key&&m>=1)v(m-1),ge();else if("ArrowDown"===e.key&&m<p.length-1)v(m+1),ge();else if(r)"Escape"===e.key?(s(4,f=!1),s(1,r=!1),s(0,c="")):"Enter"===e.key&&n.length>0&&(y(u.indexOf(n[0])),s(0,c=""),m<p.length-1&&v(m+1));else if(k.has(e.key)){const t=parseInt(e.key)-1;t<u.length&&y(t),m<p.length-1&&v(m+1)}else"e"===e.key?b():"Escape"===e.key?w():"/"===e.key&&(s(1,r=!0),ge())}O((()=>{window.addEventListener("paste",x),window.addEventListener("copy",E),window.addEventListener("keydown",I)}));return e.$$.update=()=>{65539&e.$$.dirty[0]&&s(7,n=u.filter((e=>!r||(e.name?e.name.toLowerCase().match(c.toLowerCase()):console.log("card with missing name",u))))),4&e.$$.dirty[0]&&s(8,a=Object.keys(g).length)},[c,r,g,h,f,p,m,n,a,o,l,v,y,b,function(){s(4,f=!f)},function(){s(1,r=!r)},u,function(e){h=e,s(3,h)},function(){c=this.value,s(0,c)},e=>y(e),e=>v(e)]}export default class extends e{constructor(e){super(),t(this,e,ve,me,s,{},[-1,-1])}}
